<div class="p-6 bg-slate-950 min-h-screen text-slate-100">
  <h1 class="text-3xl font-bold mb-6">Analíticas del sistema</h1>

  <!-- Error -->
  <div *ngIf="error" class="mb-4 rounded-xl bg-red-900/40 border border-red-500 px-4 py-3 text-sm">
    {{ error }}
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="mb-4 text-sm text-slate-400">
    Cargando datos...
  </div>

  <!-- KPIs -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
    <div class="p-4 bg-slate-900 rounded-xl border border-slate-800">
      <p class="text-slate-400 text-sm">Búsquedas totales</p>
      <h2 class="text-2xl font-semibold mt-1">{{ kpis.totalBusquedas }}</h2>
    </div>

    <div class="p-4 bg-slate-900 rounded-xl border border-slate-800">
      <p class="text-slate-400 text-sm">Documentos encontrados</p>
      <h2 class="text-2xl font-semibold mt-1">{{ kpis.totalDocumentos }}</h2>
    </div>

    <div class="p-4 bg-slate-900 rounded-xl border border-slate-800">
      <p class="text-slate-400 text-sm">Usuarios únicos</p>
      <h2 class="text-2xl font-semibold mt-1">{{ kpis.usuariosUnicos }}</h2>
    </div>
  </div>

  <!-- Gráficos -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
    <div class="bg-slate-900 p-4 rounded-xl border border-slate-800">
      <h3 class="text-lg font-semibold mb-3">Búsquedas por día</h3>
      <canvas
        baseChart
        [data]="busquedasChartData"
        [type]="'bar'">
      </canvas>
    </div>

    <div class="bg-slate-900 p-4 rounded-xl border border-slate-800">
      <h3 class="text-lg font-semibold mb-3">Documentos populares</h3>
      <canvas
        baseChart
        [data]="documentosChartData"
        [type]="'pie'">
      </canvas>
    </div>
  </div>

  <!-- Últimas búsquedas -->
  <div class="bg-slate-900 p-4 rounded-xl border border-slate-800">
    <h3 class="text-lg font-semibold mb-4">Últimas búsquedas</h3>

    <div class="overflow-x-auto">
      <table class="w-full text-left text-sm">
        <thead class="text-slate-400 border-b border-slate-700">
          <tr>
            <th class="py-2">Usuario</th>
            <th>Query original</th>
            <th>Interpretado (Vertex)</th>
            <th>Fecha</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let b of ultimasBusquedas" class="border-b border-slate-800">
            <td class="py-2">{{ b.usuario }}</td>
            <td>{{ b.original }}</td>
            <td class="text-slate-400">{{ b.search_phrase }}</td>
            <td>{{ b.fecha | date:'short' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>